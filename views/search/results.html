<div id="main" style="width: 75%" ng-init="getResults(searchTerm)">

	<div ng-show="searchLoading == true" class="loading">
		<i class="fa fa-refresh fa-spin"></i>
	</div>

	<div ng-show="noResultsFilter == true" class="no-results">
		No results correspond with your filters
	</div>
	
	<div ng-show="searchLoading == false" ng-repeat="item in results" class="item">
		<label class="item-select" for="{{item._source._id}}"></label>
		<input type="checkbox" id="{{item._source._id}}">
		<a href="" class="item-detail">
			<img src="http://www.erasmusbooks.nl/main/tools/Scale.aspx?size=1&PR={{item._source.isbn}}" alt="{{item._source.title}}">
			<div class="item-title" ng-bind-html="item._source.title | highlight: searchedFor">Title</div>
		</a>
		<div class="item-author" ng-show="item._source.author" ng-bind-html="item._source.author | highlight: searchedFor">Item author(s)</div>
	
		<dl class="item-meta">
			<dt>Publisher:</dt>
			<dd><span ng-bind-html="item._source.publisher | highlight: searchedFor"></span></dd>
			<dt>Place:</dt>
			<dd>
				<span>{{item._source.place}}</span><span ng-show="item._source.place && item._source.country">,</span>
				<span>{{item._source.country}}</span>
				<span ng-show="item._source.date">({{item._source.date}})</span>
			</dd>
			<dt>ISBN:</dt>
			<dd><span ng-bind-html="item._source.isbn | highlight: searchedFor" ng-show="item._source.isbn"></span><span ng-hide="item._source.isbn">&nbsp;</span></dd>
			<dt>Product type:</dt>
			<dd>{{item._source.group}}<span ng-show="item._source.pages > 0">, {{item._source.pages}} pages</span></dd>
			<dt>Availability:</dt>
			<dd><i class="available"></i> {{item._source.status}}</dd>
		</dl>
		
		<div class="item-sidebar">
			<div class="item-price" ng-show="item._source.price > 0"><strong>{{item._source.price}}</strong> EUR</div>
			<div class="item-price unknown" ng-show="item._source.price <= 0">Price unknown</div>

			<div class="item-actions" ng-class="{active: cartsDropdown.active == item._id}">
				<button type="button" class="cart">Add to cart</button>
				<button type="button" class="more" ng-focus="focusCarts(item)" ng-blur="blurCarts()"><i class="fa fa-caret-down"></i></button>

				<span class="indicator" ng-show="cartsDropdown.active == item._id"></span>
				<ul class="carts-list" ng-show="cartsDropdown.active == item._id">
					<li ng-repeat="cart in cartsDropdown.carts">
						<a href="" title="{{cart.title}}">
							<span class="cart-no">{{$index + 1}}.</span>
							<span class="cart-title">{{cart.title}}</span>
							<span class="cart-amount">
								<i class="fa fa-shopping-cart"></i> {{cart.amount}}
							</span>
							<span class="cart-price">
								<i class="fa fa-credit-card"></i> {{cart.price}} EUR
							</span>
						</a>
					</li>
				</ul>
			</div>
	
			<ul class="item-links">
				<li><a href="">More information</a></li>
			</ul>
		</div>
	</div>


</div>

<aside ng-show="noResults == false" style="width: 25%">
	<div class="pagination">
		<a href="" class="prev" ng-show="pagination.page > 0" ng-click="searchPage('first', searchedFor)" title="First">
			<i class="fa fa-angle-double-left"></i>
		</a>
		<a href="" class="prev" ng-show="pagination.page > 1" ng-click="searchPage('prev', searchedFor)" title="Previous">
			<i class="fa fa-angle-left"></i>
		</a>

		<span ng-hide="results">
			<i class="fa fa-refresh fa-spin"></i>
		</span>
		<span ng-show="results">
			{{pagination.page + 1}} of {{pagination.pages}}
		</span>
		
		<a href="" class="next" ng-show="pagination.page + 1 < pagination.pages" ng-click="searchPage('last', searchedFor)" title="Last">
			<i class="fa fa-angle-double-right"></i>
		</a>
		<a href="" class="next" ng-show="pagination.page + 2 < pagination.pages" ng-click="searchPage('next', searchedFor)" title="Next">
			<i class="fa fa-angle-right"></i>
		</a>
	</div>

	<dl class="page-details">
		<dt>Criteria:</dt>
		<dd><em>{{searchedFor}}</em><span ng-hide="searchedFor">&nbsp;</span></dd>
		<dt>Results:</dt>
		<dd>{{total}}<span ng-hide="results.count">&nbsp;</span></dd>
		<dt>Sort by:</dt>
		<dd>
			<span href="" class="dropdown"><a>{{currentSortMethod.name}}</a>
				<ul>
					<li ng-repeat="method in sortMethods">
						<a href="" ng-class="{active: method.slug == currentSortMethod.slug}" ng-click="sortResults($index, searchedFor)">{{method.name}}</a>
					</li>
				</ul>
			</span>
			<span href="" class="dropdown" ng-hide="currentSortMethod.slug == 'relevance'"> / 
				<a ng-show="sortOrder == 'asc'">Ascending</a>
				<a ng-show="sortOrder == 'desc'">Descending</a>
				<ul>
					<li>
						<a href="" ng-class="{active: sortOrder == 'asc'}" ng-click="sortDirection('asc', searchedFor)">Ascending</a>
					</li>
					<li>
						<a href="" ng-class="{active: sortOrder == 'desc'}" ng-click="sortDirection('desc', searchedFor)">Descending</a>
					</li>
				</ul>
			</span>
		</dd>
		<dt>Currency:</dt>
		<dd>
			<span href="" class="dropdown"><a>Original</a>
				<ul>
					<li><a href="" class="active">Original</a></li>
					<li><a href="">EUR</a></li>
					<li><a href="">USD</a></li>
					<li><a href="">GBP</a></li>
					<li><a href="">JPY</a></li>
				</ul>
			</span>
		</dd>
	</dl>

	<div class="page-functions">
		<a href="">Select all</a>
	</div>

	<div class="filters">
		<div class="filter" ng-class="filterState.status">
			<h3 ng-click="filterDisplay('status')">
				<i class="fa fa-chevron-up" ng-class="{'fa-chevron-down': filterState.status == 'open'}"></i> 
				Availability
				<span ng-show="filter.status.length > 0 && filterState.status == 'close'">{{filter.status.length}} active</span>
			</h3>
			<ul>
				<li ng-repeat="option in aggs.status.set.buckets" ng-class="{active: filter['status'].indexOf(option.key) > -1}">
					<label>
						<input type="checkbox" ng-checked="filter['status'].indexOf(option.key) > -1" ng-click="filterToggle('status', option.key)">
						{{option.key}} <span>({{option.doc_count}})</span>
						<i class="fa fa-remove"></i>
					</label>
				</li>
				<li ng-show="filter['status'].length > 0"><a href="" ng-click="filterToggle('status')">Clear filters</a></li>
			</ul>
		</div>

		<div class="filter" ng-class="filterState.group">
			<h3 ng-click="filterDisplay('group')">
				<i class="fa fa-chevron-up" ng-class="{'fa-chevron-down': filterState.group == 'open'}"></i> 
				Product type
				<span ng-show="filter.group.length > 0 && filterState.group == 'close'">{{filter.group.length}} active</span>
			</h3>
			<ul>
				<li ng-repeat="option in aggs.group.set.buckets" ng-class="{active: filter['group'].indexOf(option.key) > -1}">
					<label>
						<input type="checkbox" ng-checked="filter['group'].indexOf(option.key) > -1" ng-click="filterToggle('group', option.key)"> 
						{{option.key}} <span>({{option.doc_count}})</span>
						<i class="fa fa-remove"></i>
					</label>
				</li>
				<li ng-show="filter['group'].length > 0"><a href="" ng-click="filterToggle('group')">Clear filters</a></li>
			</ul>
		</div>

		<div class="filter" ng-class="filterState.country">
			<h3 ng-click="filterDisplay('country')">
				<i class="fa fa-chevron-up" ng-class="{'fa-chevron-down': filterState.country == 'open'}"></i> 
				Countries
				<span ng-show="filter.country.length > 0 && filterState.country == 'close'">{{filter.country.length}} active</span>
			</h3>
			<ul>
				<li ng-repeat="option in aggs.country.set.buckets" ng-class="{active: filter['country'].indexOf(option.key) > -1}">
					<label>
						<input type="checkbox" ng-checked="filter['country'].indexOf(option.key) > -1" ng-click="filterToggle('country', option.key)"> 
						{{option.key}} <span>({{option.doc_count}})</span>
						<i class="fa fa-remove"></i>
					</label>
				</li>
				<li ng-show="filter['country'].length > 0"><a href="" ng-click="filterToggle('country')">Clear filters</a></li>
			</ul>
		</div>
	</div>

</aside>

<div ng-show="noResults == true" class="no-results">
	No results for <em>{{searchedFor}}</em>
</div>